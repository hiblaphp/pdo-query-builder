#!/usr/bin/env php
<?php

declare(strict_types=1);

$autoloadPaths = [
    __DIR__ . '/../../../autoload.php',     
    __DIR__ . '/../vendor/autoload.php',  
    __DIR__ . '/../../../vendor/autoload.php', 
];

foreach ($autoloadPaths as $file) {
    if (file_exists($file)) {
        require $file;
        break;
    }
}

if (!class_exists('Symfony\Component\Console\Application')) {
    fwrite(STDERR, 'Error: Symfony Console not found. Run "composer require symfony/console"' . PHP_EOL);
    exit(1);
}

use Hibla\PdoQueryBuilder\Console\InitCommand;
use Hibla\PdoQueryBuilder\Console\StatusCommand;
use Hibla\PdoQueryBuilder\Console\MakeMigrationCommand;
use Hibla\PdoQueryBuilder\Console\MigrateCommand;
use Hibla\PdoQueryBuilder\Console\MigrateRollbackCommand;
use Hibla\PdoQueryBuilder\Console\MigrateResetCommand;
use Hibla\PdoQueryBuilder\Console\MigrateRefreshCommand;
use Hibla\PdoQueryBuilder\Console\MigrateStatusCommand;
use Symfony\Component\Console\Application;

$app = new Application('PDO Query Builder', '1.0.0');

// Configuration commands
$app->add(new InitCommand());
$app->add(new StatusCommand());

// Migration commands
$app->add(new MakeMigrationCommand());
$app->add(new MigrateCommand());
$app->add(new MigrateRollbackCommand());
$app->add(new MigrateResetCommand());
$app->add(new MigrateRefreshCommand());
$app->add(new MigrateStatusCommand());

$app->run();